var e=Object.defineProperty,t=(t,s,i)=>((t,s,i)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[s]=i)(t,"symbol"!=typeof s?s+"":s,i);import{p as s}from"./phaser-CwoquCe3.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();class i extends s.Scene{constructor(){super("Boot")}preload(){this.load.image("background","/games/methbreaker/bg.png")}create(){this.scene.start("Preloader")}}const a=new s.Events.EventEmitter;class l extends s.Scene{constructor(){super("GameOver"),t(this,"camera"),t(this,"background"),t(this,"gameOverText")}create(){this.camera=this.cameras.main,this.camera.setBackgroundColor(16711680),this.background=this.add.image(512,384,"background"),this.background.setAlpha(.5),this.gameOverText=this.add.text(512,384,"Game Over",{fontFamily:"Arial Black",fontSize:64,color:"#ffffff",stroke:"#000000",strokeThickness:8,align:"center"}).setOrigin(.5).setDepth(100),a.emit("current-scene-ready",this)}changeScene(){this.scene.start("MainMenu")}}const r=[{title:'"We need to cook"',bg:"level_1",body:["0000000000000000","0000000000000000","0111111111111110","0000000000000000","0000000000000000","0111111111111110","0000000000000000","0000000000000000","0111111111111110"]},{title:"W.W.",bg:"level_2",body:["0000000000000000","0000000000000000","0010101001010100","0010101001010100","0010101001010100","0010101001010100","0001010000101000","0000000000000000","0000000000000000"]},{title:"It's supposed to be an RV",bg:"level_3",body:["0000000000000000","0000000000000000","0111111111111110","0111111111100110","0111111111111110","0001100000011000","0000000000000000","0000000000000000","0000000000000000"]},{title:"737",bg:"level_4",body:["0000000000000000","0000000000000000","0111100110011110","0000101001000010","0001000010000100","0010001001001000","0010000110001000"]},{title:"Heisenberg",bg:"level_5",body:["0000000000000000","0000011111100000","0000011111100000","0000111111110000","0000000000000000","0000111001110000","0001111111111000","0000111001110000","0000000000000000","0000000110000000","0000001001000000","0000001111000000","0000001111000000"]}];class n extends s.Scene{constructor(){super("Game"),t(this,"game_state",0),t(this,"lives",0),t(this,"current_level",null),t(this,"current_level_index",0),t(this,"level_stats_collected",0),t(this,"level_stats_total_bricks",0),t(this,"level_stats_time",0),t(this,"state_timer",0),t(this,"paddle_speed",400),t(this,"paddle_focus_speed",215),t(this,"ball_speed",175),t(this,"ball_turbo_speed",300),t(this,"ball_angle_coeff",6),t(this,"paddle_angle_influence",.75),t(this,"level_data"),t(this,"Background"),t(this,"Camera"),t(this,"Paddle"),t(this,"PaddleTween"),t(this,"PaddleFX"),t(this,"Balls"),t(this,"Bricks"),t(this,"Pickups"),t(this,"Keys"),t(this,"SceneText"),t(this,"LivesCounter"),t(this,"addScore")}update(e,t){var s;if(!this.Keys)return;if(!this.Paddle)return;this.state_timer+=t/1e3,this.level_stats_time+=t/1e3;let i=0;if(1==this.game_state||2==this.game_state){let e=this.paddle_speed;this.Keys.focus.isUp&&(e=this.paddle_focus_speed),this.Keys.left.isDown?i=-e:this.Keys.right.isDown&&(i=e),this.Paddle.setVelocity(i,0)}else this.Paddle.setVelocity(0,0);1==this.game_state?this.PaddleTween&&Phaser.Input.Keyboard.JustDown(this.Keys.shoot)&&!this.PaddleTween.isPlaying()&&this.PaddleTween.reset():4==this.game_state?this.state_timer>1&&this.changeGameState(2):3==this.game_state?this.state_timer>5&&(this.current_level_index=this.current_level_index+1,this.buildLevel(this.current_level_index),this.changeGameState(4)):5==this.game_state?this.state_timer>1&&(this.resetPaddleBall(),this.changeGameState(4)):6==this.game_state||2==this.game_state&&(null==(s=this.Balls)||s.children.iterate((e=>{let t=e;const s=t.scene;return s.Paddle&&s.Paddle.body?(t.setPosition(s.Paddle.body.position.x+37.5,250),null):null})),Phaser.Input.Keyboard.JustDown(this.Keys.shoot)&&this.changeGameState(1))}create(){var e;this.input.keyboard&&(this.Keys=this.input.keyboard.addKeys({left:Phaser.Input.Keyboard.KeyCodes.LEFT,right:Phaser.Input.Keyboard.KeyCodes.RIGHT,focus:Phaser.Input.Keyboard.KeyCodes.SHIFT,shoot:Phaser.Input.Keyboard.KeyCodes.UP}),this.level_data=r,this.physics.world.setBounds(0,0,400,332),this.Camera=this.cameras.main,this.Camera.setBackgroundColor(2105376),this.Balls=this.physics.add.group(),this.Bricks=this.physics.add.staticGroup(),this.physics.world.addCollider(this.Bricks,this.Balls,((e,t)=>{var s,i;let a=e;if("brick_0"==a.anims.getName()){const e=null==(s=a.preFX)?void 0:s.addBarrel(1.5);this.tweens.add({targets:e,amount:1,duration:100}),a.play("brick_1")}else this.createPickup(a.body.position.x+12.5,a.body.position.y+7.5),a.destroy(),1==this.game_state&&0==(null==(i=this.Bricks)?void 0:i.getLength())&&this.changeGameState(3)})),this.Paddle=this.physics.add.sprite(200,275,"paddle"),this.Paddle.scale=.5,this.Paddle.setCollideWorldBounds(),this.Paddle.setPushable(!1),this.PaddleFX=null==(e=this.Paddle.preFX)?void 0:e.addBarrel(1),this.physics.world.addCollider(this.Paddle,this.Balls,((e,t)=>{let s=t,i=e;if(!s.body||!i.body)return;const a=(s.body.position.x-37.5-i.body.position.x)*this.ball_angle_coeff;s.setVelocityX(a*this.paddle_angle_influence+s.body.velocity.x*(1-this.paddle_angle_influence)),this.PaddleTween&&this.PaddleTween.isPlaying()?s.setVelocityY(-this.ball_turbo_speed):s.setVelocityY(-this.ball_speed),this.PaddleFX&&(this.PaddleFX.amount=1.2,this.tweens.add({targets:this.PaddleFX,amount:1,duration:200}))})),this.PaddleTween=this.tweens.add({targets:this.Paddle,y:"-=20",ease:"linear",duration:100,repeat:0,yoyo:!0,persist:!0}),this.PaddleTween.stop(),this.Pickups=this.physics.add.group(),this.physics.world.addCollider(this.Pickups,this.Paddle,((e,t)=>{let s=t;const i=document.getElementById("score");i&&(i.innerHTML=`${parseInt(i.innerHTML)+1}`),this.level_stats_collected+=1,s.destroy()})),this.SceneText=this.add.group(),this.LivesCounter=this.add.text(10,10,"balls",{fontFamily:"Arial Black",fontSize:14,color:"#ffffff",stroke:"#000000",strokeThickness:2,align:"left"}).setOrigin(0).setDepth(500),this.setLives(3),this.physics.world.on("worldbounds",this.onWorldBounds),this.current_level_index=0,this.buildLevel(this.current_level_index),this.changeGameState(4),a.emit("current-scene-ready",this))}onWorldBounds(e,t,s,i,a){const l=e.gameObject.scene;l.Balls&&l.Pickups&&(l.Balls.contains(e.gameObject)?s&&(l.setLives(l.lives-1),e.gameObject.destroy(),1==l.game_state&&0==l.Balls.getLength()&&l.changeGameState(5)):l.Pickups.contains(e.gameObject)&&s&&e.gameObject.destroy())}changeGameState(e){if(this.Balls&&this.Pickups&&this.Paddle&&this.SceneText&&this.level_data)switch(this.state_timer=0,this.SceneText.clear(!0),this.game_state=e,e){case 4:this.Balls.setVelocity(0,0),this.SceneText.add(this.add.text(200,125,"LEVEL "+(this.current_level_index+1).toString(),{fontFamily:"Arial Black",fontSize:28,color:"#ffffff",stroke:"#000000",strokeThickness:4,align:"center"}).setOrigin(.5).setDepth(500)),this.SceneText.add(this.add.text(200,175,this.current_level?this.current_level.title:"",{fontFamily:"Arial Black",fontSize:20,color:"#ffffff",stroke:"#000000",strokeThickness:3,align:"center"}).setOrigin(.5).setDepth(500));break;case 1:this.Balls.setVelocity(Phaser.Math.FloatBetween(-30,30),-this.ball_speed);break;case 3:this.Balls.setVelocity(0,0),this.Pickups.children.iterate((e=>{const t=e,s=e.scene;return s&&s.Paddle&&s.Paddle.body&&t.body?(this.level_stats_collected+=1,t&&(t.setAcceleration(0,0),t.setMaxVelocity(1e3,1e3),t.setVelocity(s.Paddle.body.position.x+37.5-t.body.position.x,s.Paddle.body.position.y-t.body.position.y)),null):null})),this.SceneText.add(this.add.text(200,115,"LEVEL CLEAR",{fontFamily:"Arial Black",fontSize:30,color:"#ffffff",stroke:"#000000",strokeThickness:4,align:"center"}).setOrigin(.5).setDepth(500));const e=Math.floor(this.level_stats_time);this.SceneText.add(this.add.text(200,150,"TIME: "+Math.floor(e/60).toString()+(e<10?":0":":")+(e%60).toString(),{fontFamily:"Arial Black",fontSize:20,color:"#ffffff",stroke:"#000000",strokeThickness:3,align:"center"}).setOrigin(.5).setDepth(500));const t=Math.ceil(this.level_stats_collected/this.level_stats_total_bricks*1e3)/10;this.SceneText.add(this.add.text(200,175,`COOK: ${t}% Pure (${this.level_stats_collected}/${this.level_stats_total_bricks})`,{fontFamily:"Arial Black",fontSize:20,color:"#ffffff",stroke:"#000000",strokeThickness:3,align:"center"}).setOrigin(.5).setDepth(500));let s="F",i="#FF8800";t>=90?(s="A",i="#FF0000",this.setLives(this.lives+1),this.SceneText.add(this.add.text(250,215,"+1UP",{fontFamily:"Arial Black",fontSize:20,color:"#00FF00",stroke:"#000000",strokeThickness:2,align:"center"}).setOrigin(.5).setDepth(500))):t>=80?(s="B",i="#00FF00"):t>=70?(s="C",i="#0088FF"):t>=60&&(s="D",i="#880088"),this.SceneText.add(this.add.text(200,215,s,{fontFamily:"Arial Black",fontSize:40,color:i,stroke:"#000000",strokeThickness:5,align:"center"}).setOrigin(.5).setDepth(500));break;case 5:this.Balls.setVelocity(0,0);break;case 6:this.Balls.setVelocity(0,0),this.Pickups.clear(!0),this.SceneText.add(this.add.text(200,150,"YOU DIED",{fontFamily:"Arial Black",fontSize:28,color:"#ffffff",stroke:"#000000",strokeThickness:4,align:"center"}).setOrigin(.5).setDepth(500))}}setLives(e){if(this.lives=e,this.LivesCounter)if(this.lives<0)this.LivesCounter.text="Balls: ",this.changeGameState(6);else{let e="";for(let t=0;t<this.lives;t++)e+="O";this.LivesCounter.text="Balls: "+e}}resetPaddleBall(){var e;this.createBall(200,250),this.PaddleTween&&this.PaddleTween.stop(),null==(e=this.Paddle)||e.setPosition(200,275)}clearLevel(){this.Balls&&this.Bricks&&this.Pickups&&this.Paddle&&(this.Balls.clear(!0),this.Bricks.clear(!0),this.Pickups.clear(!0),this.Background&&this.Background.destroy())}buildLevel(e){if(this.level_data){this.clearLevel(),this.resetPaddleBall(),this.level_stats_collected=0,this.level_stats_time=0,this.level_stats_total_bricks=0,this.current_level=this.level_data[e%this.level_data.length],this.current_level,this.Background=this.add.image(200,150,this.current_level.bg),this.Background.depth=-100;for(let e=0;e<this.current_level.body.length;e++)for(let t=0;t<this.current_level.body[e].length;t++)switch(this.current_level.body[e][t]){case"0":break;case"1":this.createBrick(t,e),this.level_stats_total_bricks+=1}}}createBall(e,t){if(!this.Balls)return;let s=this.physics.add.sprite(e,t,"ball");this.Balls.add(s),s.setDepth(100),s.setCollideWorldBounds(!0),s.body.onWorldBounds=!0,s.setVelocity(0,0),s.setBounce(1,1)}createBrick(e,t){if(!this.Bricks)return;let s=this.physics.add.staticSprite(12.5+25*e,7.5+15*t,"brick");this.Bricks.add(s),s.play("brick_0")}createPickup(e,t){var s,i;if(!this.Pickups)return;let a=this.physics.add.sprite(e,t,"meth");this.Pickups.add(a),null==(s=a.preFX)||s.addGlow(65535,1);const l=null==(i=a.preFX)?void 0:i.addBarrel(2);this.tweens.add({targets:l,amount:1,duration:100}),a.setCollideWorldBounds(!0),a.body.onWorldBounds=!0,a.setAcceleration(0,150),a.setMaxVelocity(0,75),a.setVelocity(0,-75)}changeScene(){this.scene.start("GameOver")}}class o extends s.Scene{constructor(){super("MainMenu"),t(this,"background")}create(){this.background=this.add.image(200,150,"main_menu").setScale(.5),this.add.text(200,50,"AMC presents:",{fontFamily:"Arial Black",fontSize:19,color:"#ffffff",stroke:"#000000",strokeThickness:4,align:"center"}).setOrigin(.5).setDepth(100),this.add.text(200,100,"Methbreaker",{fontFamily:"Arial Black",fontSize:38,color:"#ffffff",stroke:"#000000",strokeThickness:8,align:"center"}).setOrigin(.5).setDepth(100),this.add.text(200,200,"Click to Play!",{fontFamily:"Arial Black",fontSize:30,color:"#ffffff",stroke:"#000000",strokeThickness:8,align:"center"}).setOrigin(.5).setDepth(100),this.input.on("pointerdown",(()=>{this.changeScene()})),a.emit("current-scene-ready",this)}changeScene(){this.scene.start("Game")}}class d extends s.Scene{constructor(){super("Preloader")}init(){this.add.image(200,150,"background"),this.add.rectangle(200,150,300,32).setStrokeStyle(1,16777215);const e=this.add.rectangle(-30,150,4,28,16777215);this.load.on("progress",(t=>{e.width=4+296*t}))}preload(){this.load.setPath("/games/methbreaker"),this.load.image("logo","logo.png"),this.load.image("star","star.png"),this.load.image("main_menu","main_menu.png"),this.load.image("paddle","paddle.png"),this.load.image("ball","ball.png"),this.load.spritesheet("brick","meth_block.png",{frameWidth:25,frameHeight:15}),this.load.image("meth","meth.png"),this.load.image("level_1","level_1.png"),this.load.image("level_2","level_2.png"),this.load.image("level_3","level_3.png"),this.load.image("level_4","level_4.png"),this.load.image("level_5","level_5.png")}create(){this.anims.create({key:"brick_0",repeat:0,frames:[{key:"brick",frame:0}]}),this.anims.create({key:"brick_1",repeat:0,frames:[{key:"brick",frame:1}]}),this.scene.start("MainMenu")}}const h={type:s.AUTO,width:400,height:300,parent:"game-container",backgroundColor:"#028af8",scene:[i,d,o,n,l],physics:{default:"arcade"}};new s.Game(h);
